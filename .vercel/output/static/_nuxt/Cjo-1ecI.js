import{_ as z}from"./B9ORdSW3.js";import{_ as A}from"./DKFfuTk7.js";import{_ as T}from"./Bbk0fRQu.js";import{_ as H}from"./1mwErJ78.js";import{_ as O}from"./qIMO2IYi.js";import{_ as P}from"./BUmjikbw.js";import{_ as R,a as F}from"./C0CVT-Gk.js";import{e as q,r as l,l as I,x as L,c as p,b as n,w as i,i as a,a as s,F as G,y as J,j as K,o as u,d as c,m as Q,t as v,h as W}from"./BlCT4Jl9.js";import{u as X}from"./tIBO3SJJ.js";const Y={key:0,class:"flex items-center justify-center py-12"},Z={key:1,class:"text-center py-12"},ee={key:2,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},oe={class:"flex items-start justify-between mb-4"},te={class:"text-xl font-bold text-gray-800 mb-1"},ae={class:"text-gray-500 mb-3"},se={class:"flex items-center gap-2 text-sm text-gray-600"},ne={class:"mt-3 pt-3 border-t border-gray-100"},re={class:"text-sm text-gray-500"},le={class:"flex justify-end gap-3 pt-4"},ye=q({__name:"departamentos",setup(ie){const{nomeAdmin:y,buscarAdmin:h}=X(),d=l(!1),f=l(null),r=l({nome:"",descricao:"",responsavel:""}),b=l(!0),_=l(!1),g=l(!1),x=l({title:"",message:"",variant:"success"}),k=l([]),U=I(()=>[{value:y.value,label:`${y.value} (Admin) â­`}]);L(async()=>{await h(),await C()});const C=async()=>{b.value=!0;try{const o=await $fetch("/api/departamentos");o.success&&o.data&&(k.value=o.data.map(e=>({...e,funcionarios:0})))}catch(o){console.error("Erro ao carregar departamentos:",o),V("Erro!","NÃ£o foi possÃ­vel carregar departamentos","error")}finally{b.value=!1}},w=o=>{f.value=o||null,r.value=o?{nome:o.nome,descricao:o.descricao,responsavel:o.responsavel}:{nome:"",descricao:"",responsavel:y.value},d.value=!0},N=async()=>{_.value=!0;try{const o=f.value?{...r.value,id:f.value.id}:r.value,e=await $fetch("/api/departamentos/criar",{method:"POST",body:o});e.success&&(V("Sucesso!",e.message,"success"),d.value=!1,await C())}catch(o){console.error("Erro ao salvar departamento:",o),V("Erro!",o.data?.message||"NÃ£o foi possÃ­vel salvar o departamento","error")}finally{_.value=!1}},V=(o,e,m)=>{x.value={title:o,message:e,variant:m},g.value=!0,setTimeout(()=>{g.value=!1},5e3)};return(o,e)=>{const m=z,D=A,M=T,S=H,$=O,j=P,B=R,E=F;return u(),p("div",null,[n(D,{title:"Departamentos",description:"Organize os setores da empresa"},{default:i(()=>[n(m,{size:"lg",icon:"âž•",onClick:e[0]||(e[0]=t=>w())},{default:i(()=>[...e[8]||(e[8]=[c(" Novo Departamento ",-1)])]),_:1})]),_:1}),a(b)?(u(),p("div",Y,[...e[9]||(e[9]=[s("div",{class:"text-center"},[s("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),s("p",{class:"text-gray-600"},"Carregando departamentos...")],-1)])])):a(k).length===0?(u(),p("div",Z,[e[11]||(e[11]=s("p",{class:"text-gray-500 mb-4"},"Nenhum departamento cadastrado",-1)),n(m,{onClick:e[1]||(e[1]=t=>w())},{default:i(()=>[...e[10]||(e[10]=[c("âž• Criar Primeiro Departamento",-1)])]),_:1})])):(u(),p("div",ee,[(u(!0),p(G,null,J(a(k),t=>(u(),Q(M,{key:t.id,padding:"p-6"},{default:i(()=>[s("div",oe,[e[13]||(e[13]=s("div",{class:"w-14 h-14 bg-purple-100 rounded-xl flex items-center justify-center"},[s("svg",{class:"w-7 h-7 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])],-1)),n(m,{variant:"ghost",size:"sm",onClick:me=>w(t)},{default:i(()=>[...e[12]||(e[12]=[c("âœï¸ Editar",-1)])]),_:1},8,["onClick"])]),s("h3",te,v(t.nome),1),s("p",ae,v(t.descricao),1),s("div",se,[e[14]||(e[14]=s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),c(" ResponsÃ¡vel: "+v(t.responsavel),1)]),s("div",ne,[s("span",re,v(t.funcionarios)+" funcionÃ¡rios",1)])]),_:2},1024))),128))])),n(B,{modelValue:a(d),"onUpdate:modelValue":e[6]||(e[6]=t=>K(d)?d.value=t:null),title:a(f)?"Editar Departamento":"Novo Departamento"},{default:i(()=>[s("form",{onSubmit:W(N,["prevent"]),class:"space-y-4"},[n(S,{modelValue:a(r).nome,"onUpdate:modelValue":e[2]||(e[2]=t=>a(r).nome=t),label:"Nome do Departamento",required:""},null,8,["modelValue"]),n($,{modelValue:a(r).descricao,"onUpdate:modelValue":e[3]||(e[3]=t=>a(r).descricao=t),label:"DescriÃ§Ã£o"},null,8,["modelValue"]),n(j,{modelValue:a(r).responsavel,"onUpdate:modelValue":e[4]||(e[4]=t=>a(r).responsavel=t),options:a(U),label:"ResponsÃ¡vel",placeholder:"Selecione..."},null,8,["modelValue","options"]),s("div",le,[n(m,{variant:"secondary",onClick:e[5]||(e[5]=t=>d.value=!1)},{default:i(()=>[...e[15]||(e[15]=[c("Cancelar",-1)])]),_:1}),n(m,{type:"submit",icon:"ðŸ’¾",disabled:a(_)},{default:i(()=>[c(v(a(_)?"Salvando...":"Salvar"),1)]),_:1},8,["disabled"])])],32)]),_:1},8,["modelValue","title"]),n(E,{show:a(g),title:a(x).title,message:a(x).message,variant:a(x).variant,onClose:e[7]||(e[7]=t=>g.value=!1)},null,8,["show","title","message","variant"])])}}});export{ye as default};
